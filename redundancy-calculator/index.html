<html ng-app='redundancyApp'>

<head>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular.min.js"></script>
<script>
var myApp = angular.module('redundancyApp', []);
myApp.controller('RedundancyController', ['$scope',function($scope) {
  var self = this;
  self.noticeEntitlement = function(yos) {
    if(yos < 2)  return 1;
    if(yos >12) return 12;
    return yos;
  };
  self.redundancyEntitlement = function(age, yos) {
    var ageRemaining = age;
    var entitlement = 0;
    do {
      if(ageRemaining > 41 ) {
        entitlement += 1.5;
      } else
      if (ageRemaining > 22 ) {
        entitlement += 1.0;
      } else {
        entitlement += 0.5;
      }
      ageRemaining--;
    }
    while(--yos > 0);
    return entitlement;
  };
  self.calculate = function(data) {
    var c = $scope.calculation;
    console.log("calculate", data);
    self.saveData(data);
    c.noticeEntitlement = self.noticeEntitlement(c.yos);
    c.weekly = c.salary / 52.0;
    c.entitlement = self.redundancyEntitlement(c.age, c.yos);
    c.noticePayment= c.noticeEntitlement * c.weekly;
    c.redundancyPayment= c.entitlement * c.weekly;

  };
  self.saveData = function (data) {
    var c = $scope.calculation;
    c.age = data.age;
    c.yos = data.yos;
    c.salary = data.salary;
    c.notice = data.notice;
  };
  $scope.calculation={};
  self.calculate({age:20,yos:2,salary:26000,notice:4});
}]);
</script
</head>
<body ng-controller="RedundancyController as $ctrl">
<form>
<label for="age">Age</label><input id="age" ng-model="data.age"/>
<label for="Years Of Service">Years Of Service</label><input id="Years Of Service" ng-model="data.yos"/>
<label for="Salary">Salary</label><input id="Salary" ng-model="data.salary"/>
<label for="Notice Period (Weeks)">Notice Period (Weeks)</label><input id="Notice Period (Weeks)" ng-model="data.notice"/>
<button ng-click="$ctrl.calculate(data)">Calculate</button>
</form>
<div id="Summary">
<div>Age: {{calculation.age}}</div>
<div>Years of Service: {{calculation.yos}}</div>
<div>Salary: {{calculation.salary}}</div>
<div>
<div id="interim Calculations">
<h2>Intermediate Calculations</h2>

<div>Weekly Pay: <span id="weekly">{{calculation.weekly|number:0}}</span></div>
<div>Notice Entitlement: <span>{{calculation.noticeEntitlement}}</span>
<div>Redundancy Entitlement: <span>{{calculation.entitlement}}</span>
</div>
<div id="Calculated Redundancy">
<h2>Calculated Redundancy</h2>
<div>Redundancy Value: <span id="redundancyValue">&pound;{{calculation.redundancyPayment|number:2}}</span></div>
<div>Notice Payment: &pound;{{calculation.noticePayment|number:2}}
</div>
</body></html>
